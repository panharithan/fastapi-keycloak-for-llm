flowchart TD

    %% === USERS ===
    User["ðŸ§‘ User (Browser)"] -->|HTTP:7860| UI["ðŸŽ¨ Gradio UI (app/ui.py)"]

    %% === FRONTEND TO BACKEND ===
    UI -->|REST API:8000| API["âš™ï¸ FastAPI Backend (app/app.py)"]

    %% === AUTH & MODEL INTERACTIONS ===
    API -->|OAuth2 Token Verification| KC["ðŸ”‘ Keycloak (Auth Server)"]
    API -->|Model Inference Request| Ollama["ðŸ§  Ollama Model Server"]
    API -->|Persist Chat History| Mongo["ðŸ—„ï¸ MongoDB (Chat History)"]

    %% === KEYCLOAK DB ===
    KC -->|Stores Users, Realms, Clients| Realm["ðŸ—„ï¸ Keycloak Database"]

    %% === NETWORK GROUP ===
    subgraph Docker_Network["ðŸ³ Docker Network: llm-net"]
        UI
        API
        KC
        Ollama
        Realm
        Mongo
    end

    %% === PORTS & EXTERNAL ACCESS ===
    UI -.->|"Accessible at http://localhost:7860"| User
    API -.->|"Accessible at http://localhost:8000"| User
    KC -.->|"Admin Console at http://localhost:8080"| User